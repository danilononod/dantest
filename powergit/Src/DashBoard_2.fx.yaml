DashBoard_2 As screen:
    OnVisible: |-
        =Switch(varUserEmail, "Danilo Nonod Jr.", false,
        UpdateContext({locShowSpinner_VG:true});
        Concurrent(
            
        ClearCollect(myProfileProgress,ShowColumns(SortByColumns(TrainingProfileProgress, "Modified",SortOrder.Descending), "ID","Program", "User", "Title", "TimeDura", "Progress", "DateTime", "Modified", "TotalScore", "Reg_ID_ref")),
        ClearCollect(myTrainingTopics, ShowColumns('Training Topics', "ID","Title", "Vid_Dur", "Remarks")),
        ClearCollect(myTrainingReg, ShowColumns(TrainingRegistration, "ID","Title", "TrainingModule", "StartDate", "BeltType", "Function")),
        ClearCollect(myHREmplist, ShowColumns(AddColumns(Filter(HR_EMPLIST_100421, Active="Y"),
        "EmpName", Substitute(EmployeeName, "Ã±", "ñ"),
        "ManName", Substitute(ManagerName, "Ã±", "ñ")),
        "field_Active","EmpName","ManName","field_Function"))
        );
        
        
        UpdateContext({locShowSpinner_VG:false});
        
        
        Reset(gal_FuncStat);
        Set(VRY,{});
        UpdateContext({locShowSpinner_2:true});
        UpdateContext({locShowSpinner_3:false});
        Set(VRYY,{});
        
        
        ClearCollect( AllState, ShowColumns(
            AddColumns(
                myHREmplist,
                "Progress",
                LookUp(
                    myProfileProgress,
                    User = myHREmplist[@EmpName],
                    Text(Progress*100, "0%")),
                "DateTime",
                        LookUp(
                    myProfileProgress,
                    User = myHREmplist[@EmpName],
                    DateTime),
                "TotalScore",
                       LookUp(
                    myProfileProgress,
                    User = myHREmplist[@EmpName],
                    TotalScore)
                )
            
            
            , "EmpName","field_Function","ManName","Progress", "DateTime", "TotalScore"
        ));
        
        Concurrent(
        
        ClearCollect(myFuncAllDes, AddColumns(Sort(GroupBy(AllState,"field_Function","Department"), CountRows(Department), SortOrder.Descending), "TotalQty",
                 CountRows(Department),
                  "NotYetStarted",
                  Sum(Department, IsBlank(Progress)), //&& IsBlank(TotalScore))
                  
        
                   "In-progress",
        
                    Sum(Department, !IsBlank(Progress) && Value(Progress) < 100%  //&& IsBlank(TotalScore)
                  //&& DateTime>DateValue("10/12/2021")
        
                  
        
                  ),
                           "Completed",
                  Sum(Department,Progress = "100%" //&& TotalScore >= 95 
                  
                  ),
                  
                  "TotalQtye",
                 CountRows(Department)
                  
                  
                  
                
                  )
                  
        ),
        ClearCollect(myFuncAllAsc, AddColumns(Sort(GroupBy(AllState,"field_Function","Department"), CountRows(Department), SortOrder.Descending), "TotalQty",
                 CountRows(Department),
                  "NotYetStarted",
                  Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
        
                  
                   "In-progress",
        
                    Sum(Department, !IsBlank(Progress) && Value(Progress) < 100%  //&& IsBlank(TotalScore)
                  //&& DateTime>DateValue("10/12/2021")
        
                  
        
                  ),
                           "Completed",
                  Sum(Department,Progress = "100%" //&& TotalScore >= 95 
                  
                  ),
                  
                  "TotalQtye",
                 CountRows(Department)
                  
                  
                  
                  
                  
                  
                  )
                  
        ));
        Set(timestamp_esd, Now());
        
        //To Distinct table in data
        
        ForAll(
            ForAll(Distinct(
                AllState,
                ManName
            ), {Result: ThisRecord.Value}), Collect(RETR,
            LookUp(
                AllState,
                ManName= Result
            )));
         
            ClearCollect(myFuncAllManDes, DropColumns(AddColumns(Sort(GroupBy(AllState,"ManName","Department"), CountRows(Department), SortOrder.Descending),
        "TotalQty",
                 CountRows(Department),
        
                  "NotYetStarted",
                  Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
        
                   
                   "In-progress",
        
                    Sum(Department, !IsBlank(Progress) && Value(Progress) < 100%  //&& IsBlank(TotalScore)
                  //&& DateTime>DateValue("10/12/2021")
        
                  
        
                  ),
                           "Completed",
                  Sum(Department,Progress = "100%" //&& TotalScore >= 95 
                  
                  ),
                  
                  "TotalQtye",
                 CountRows(Department),
        
                "Rate", Sum(Department, Progress) / CountRows(Department)
                  
                  ), "Department"));
               ClearCollect(AllStatze, 
            AddColumns(
                myFuncAllManDes,
                "field_Function",
                LookUp(RETR,
                    ManName = myFuncAllManDes[@ManName],
                       field_Function
                ))
                
                )
               
        ) //end Swicht statement

    Rectangle1_39 As rectangle:
        Fill: =RGBA(7, 184, 224, 1)
        Height: =115
        Width: =1366
        ZIndex: =1

    Bar_OA_NotStarted_2 As rectangle:
        Fill: =RGBA(255, 0, 0, 1)
        Height: =Bar_OA_Completed_2.Height
        OnSelect: =
        Tooltip: =Text((OA_TTLqty_NotYetStarted.Text/OA_TTLqty.Text)*100, "0%")
        Visible: =!locShowSpinner_2
        Width: =(OA_TTLqty_NotYetStarted.Text/OA_TTLqty.Text)*100
        X: =Bar_OA_Ongoing_2.X+Bar_OA_Ongoing_2.Width
        Y: =Bar_OA_Completed_2.Y
        ZIndex: =5

    Bar_OA_Ongoing_2 As rectangle:
        Fill: =RGBA(255, 255, 0, 1)
        Height: =25
        OnSelect: =
        Tooltip: =Text((OA_TTLqty_NotYetStarted.Text/OA_TTLqty.Text)*100, "0%")
        Visible: =!locShowSpinner_2
        Width: =('OA_TTLqty_In-Progress'.Text/OA_TTLqty.Text)*100
        X: =Bar_OA_Completed_2.X+Bar_OA_Completed_2.Width
        Y: =Bar_OA_Completed_2.Y
        ZIndex: =6

    Label46_5 As label:
        Align: =Align.Center
        Color: =RGBA(98, 157, 209, 1)
        Fill: =RGBA(255, 255, 255, 1)
        Height: =30
        Size: =18
        Text: =gal_FuncStat.Selected.field_Function
        Visible: =!locShowSpinner_9 && !locShowSpinner_2
        Width: =440
        X: =817
        Y: =120
        ZIndex: =7

    Icon20_2 As icon.Reload:
        Color: =RGBA(3, 92, 112, 1)
        DisabledColor: =RGBA(7, 184, 224, 1)
        Height: =46
        HoverColor: =ColorFade(Self.Color, 50%)
        Icon: =Icon.Reload
        OnSelect: |-
            =UpdateContext({locShowSpinner_VG:true});
            Concurrent(
                
            ClearCollect(myProfileProgress,ShowColumns(SortByColumns(TrainingProfileProgress, "Modified",SortOrder.Descending), "ID","Program", "User", "Title", "TimeDura", "Progress", "DateTime", "Modified", "TotalScore", "Reg_ID_ref")),
            ClearCollect(myTrainingTopics, ShowColumns('Training Topics', "ID","Title", "Vid_Dur", "Remarks")),
            ClearCollect(myTrainingReg, ShowColumns(TrainingRegistration, "ID","Title", "TrainingModule", "StartDate", "BeltType", "Function")),
            ClearCollect(myHREmplist, ShowColumns(AddColumns(Filter(HR_EMPLIST_100421, Active="Y"),
            "EmpName", Substitute(EmployeeName, "Ã±", "ñ"),
            "ManName", Substitute(ManagerName, "Ã±", "ñ")),
            "field_Active","EmpName","ManName","field_Function"))
            );
            
            
            UpdateContext({locShowSpinner_VG:false});
            
            
            Reset(gal_FuncStat);
            Set(VRY,{});
            UpdateContext({locShowSpinner_2:true});
            UpdateContext({locShowSpinner_3:false});
            Set(VRYY,{});
            
            
            ClearCollect( AllState, ShowColumns(
                AddColumns(
                    myHREmplist,
                    "Progress",
                    LookUp(
                        myProfileProgress,
                        User = myHREmplist[@EmpName],
                        Text(Progress*100, "0%")),
                    "DateTime",
                            LookUp(
                        myProfileProgress,
                        User = myHREmplist[@EmpName],
                        DateTime),
                    "TotalScore",
                           LookUp(
                        myProfileProgress,
                        User = myHREmplist[@EmpName],
                        TotalScore)
                    )
                
                
                , "EmpName","field_Function","ManName","Progress", "DateTime", "TotalScore"
            ));
            
            Concurrent(
            
            ClearCollect(myFuncAllDes, AddColumns(Sort(GroupBy(AllState,"field_Function","Department"), CountRows(Department), SortOrder.Descending), "TotalQty",
                     CountRows(Department),
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress)), //&& IsBlank(TotalScore))
                      
            
                       "In-progress",
            
                        Sum(Department, !IsBlank(Progress) && Value(Progress) < 100%  //&& IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" //&& TotalScore >= 95 
                      
                      ),
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                    
                      )
                      
            ),
            ClearCollect(myFuncAllAsc, AddColumns(Sort(GroupBy(AllState,"field_Function","Department"), CountRows(Department), SortOrder.Descending), "TotalQty",
                     CountRows(Department),
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      
                       "In-progress",
            
                        Sum(Department, !IsBlank(Progress) && Value(Progress) < 100%  //&& IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" //&& TotalScore >= 95 
                      
                      ),
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                      
                      
                      
                      )
                      
            ));
            Set(timestamp_esd, Now());
            
            //To Distinct table in data
            
            ForAll(
                Distinct(
                    AllState,
                    ManName
                ), Collect(RETR,
                LookUp(
                    AllState,
                    ManName= Result
                )));
             
                ClearCollect(myFuncAllManDes, DropColumns(AddColumns(Sort(GroupBy(AllState,"ManName","Department"), CountRows(Department), SortOrder.Descending),
            "TotalQty",
                     CountRows(Department),
            
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                       
                       "In-progress",
            
                        Sum(Department, !IsBlank(Progress) && Value(Progress) < 100%  //&& IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" //&& TotalScore >= 95 
                      
                      ),
                      
                      "TotalQtye",
                     CountRows(Department),
            
                    "Rate", Sum(Department, Progress) / CountRows(Department)
                      
                      ), "Department"));
                   ClearCollect(AllStatze, 
                AddColumns(
                    myFuncAllManDes,
                    "field_Function",
                    LookUp(RETR,
                        ManName = myFuncAllManDes[@ManName],
                           field_Function
                    ))
                    
                    )
        Tooltip: ="Click to get the latest update!"
        Visible: =!locShowSpinner_2
        Width: =42
        X: =56
        Y: =69
        ZIndex: =8

    Timer5_5 As timer:
        AutoPause: =false
        AutoStart: =true
        Duration: |-
            =//20000
            //If(locShowSpinner_2, 10000, 1000)
        OnTimerEnd: |+
            =UpdateContext({locShowSpinner_2:false});
            UpdateContext({locShowSpinner_3:false});
            //GroupBy(Gallery5_5.Selected.Department,"field_ManagerName","Department"
            //Set(CVY,GroupBy(Gallery5_5.Selected.Department,"field_ManagerName","Department"))
            
            
        OnTimerStart: |-
            =UpdateContext({locShowSpinner:true});
        Start: |
            =locShowSpinner_2 || locShowSpinner_9
        Visible: =false
        X: =114
        Y: =728
        ZIndex: =9

    locShowSpinner_9 As image:
        Image: =spinner
        Visible: =locShowSpinner_2 && !locShowSpinner_VG
        X: =665
        Y: =247
        ZIndex: =10

    Label40_4 As label:
        Height: =45
        Text: ="Loading... Please wait!"
        Visible: =locShowSpinner_2
        Width: =212
        X: =609
        Y: =227
        ZIndex: =11

    lbl_TTLqty_NotYetStarted As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =27
        Size: =If(Value(lbl_TTLqty_Completed.Text)<65%,8,0)
        Text: =Text((OA_TTLqty_NotYetStarted.Text/OA_TTLqty.Text)*100, "0%")
        Tooltip: =Text((OA_TTLqty_NotYetStarted.Text/OA_TTLqty.Text)*100, "0%") & ", NotYetStarted"
        Visible: =!locShowSpinner_2
        Width: =Bar_OA_NotStarted_2.Width
        X: =Bar_OA_NotStarted_2.X
        Y: =Bar_OA_NotStarted_2.Y
        ZIndex: =12

    Image3_6 As image:
        Height: =46
        Image: |-
            ="https://sharedspace.sharepoint.com/sites/PEXSystemsProject/Images1/WD_Culture_FootNote.PNG"
        Width: =1366
        Y: =722
        ZIndex: =13

    lbl_Refresh As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(127, 143, 169, 1)
        DisplayMode: =DisplayMode.View
        Height: =19
        Size: =10
        Text: ="Refresh"
        Visible: =!locShowSpinner_2
        Width: =67
        X: =34
        Y: =83
        ZIndex: =14

    lbl_TTLqty_Completed As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =27
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =If(Value(lbl_TTLqty_NotYetStarted.Text)<65%,8,0)
        Text: =Text((OA_TTLqty_Completed.Text/OA_TTLqty.Text)*100, "0.0%")
        Tooltip: =Text((OA_TTLqty_Completed.Text/OA_TTLqty.Text)*100, "0%") & ", Completed"
        Visible: =!locShowSpinner_2
        Width: =Bar_OA_Completed_2.Width
        X: =Bar_OA_Completed_2.X
        Y: =Bar_OA_NotStarted_2.Y
        ZIndex: =19

    StartDate_2 As datepicker:
        BorderColor: =RGBA(214, 223, 238, 1)
        Color: =RGBA(39, 67, 125, 1)
        DefaultDate: =DateValue("10/29/2021")
        Height: =29
        Size: =12
        Width: =134
        X: =1230
        Y: =80
        ZIndex: =20

    Label45_2 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Verdana
        FontWeight: =FontWeight.Lighter
        Height: =43
        Size: =30
        Text: =If(DateDiff(Today(),DateValue("10/29/2021"),TimeUnit.Days)=0, "",DateDiff(Today(),DateValue("10/29/2021"),TimeUnit.Days))
        Width: =66
        X: =1300
        ZIndex: =21

    Group10_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =21

        Label46_4 As label:
            Color: =RGBA(3, 92, 112, 1)
            Font: =Font.Verdana
            FontWeight: =FontWeight.Bold
            Height: =53
            Size: =25
            Text: =" verall"
            Visible: =!locShowSpinner_2 && !IsError(gal_FuncStat)
            Width: =265
            X: =72
            Y: =68
            ZIndex: =2

        OA_TTLqty As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =32
            Size: =15
            Text: =Sum(gal_FuncStat.AllItems,TTLqty_5.Text)
            Visible: =!locShowSpinner_2 && !IsError(gal_FuncStat)
            Width: =60
            X: =340
            Y: =78
            ZIndex: =3

        Bar_OA_Completed_2 As rectangle:
            Fill: =RGBA(54, 176, 75, 1)
            Height: =25
            OnSelect: =
            Tooltip: =Text((OA_TTLqty_NotYetStarted.Text/OA_TTLqty.Text)*100, "0%")
            Visible: =!locShowSpinner_2 && !IsError(gal_FuncStat)
            Width: =(OA_TTLqty_Completed.Text/OA_TTLqty.Text)*100
            X: =OA_TTLqty_NotYetStarted.X +OA_TTLqty_NotYetStarted.Width+5
            Y: =OA_TTLqty_NotYetStarted.Y
            ZIndex: =4

    Icon24_2 As icon.Folder:
        Color: =RGBA(39, 113, 194, 1)
        DisplayMode: =DisplayMode.View
        Height: =67
        Icon: =Icon.Clock
        X: =1248
        Y: =7
        ZIndex: =22

    Label47_4 As label:
        Align: =LayoutAlignItems.Center
        Height: =41
        Size: =10
        Text: =If(IsBlank(Label45_2.Text), "Last Day", If(Value(Label45_2.Text)=1, "Day Remaining","Days Remaining"))
        Width: =78
        X: =1288
        Y: =37
        ZIndex: =23

    btn_PerFunction_2 As button:
        OnSelect: |
            =
            ClearCollect( DepartmentByEmployee, Filter( AllState, field_Function = Label44_4.Text  ) );
            
            
            ClearCollect(HARD, DropColumns(AddColumns(DepartmentByEmployee,"Remarks",
            If(IsBlank(Progress) //&& IsBlank(TotalScore)
            , "NotYetStarted",
            If(Value(Progress) < 100% //&& IsBlank(TotalScore)
            ,"In-progress",
            If(Progress = "100%","Completed")))),"TotalScore"));
            
            /*
            ForAll(HARD, Collect(HARDY, {EmpName: Substitute(EmpName, "Ã±", "ñ"), ManName: Substitute(ManName, "Ã±", "ñ"), DateTime: DateTime, Progress:
            Progress, Remarks: Remarks, Function: field_Function}));
            */
            
            Set(varExport, ExportDataFromPowerApps.Run(JSON(HARD,JSONFormat.IncludeBinaryData & JSONFormat.IgnoreUnsupportedTypes)).filelink); Launch(varExport); Clear(HARD)
        Text: ="ExportData"
        Visible: =!IsBlank(Label44_4.Text)
        X: =925
        Y: =607
        ZIndex: =24

    Label44_4 As label:
        Align: =Align.Center
        Height: =32
        Text: =Label46_5.Text
        Visible: =!locShowSpinner_9 && !locShowSpinner_2
        Width: =235
        X: =893
        Y: =564
        ZIndex: =25

    Label34_5 As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =74
        Size: =25
        Text: ="ESD Certification Compliance"
        Width: =612
        X: =700
        Y: =7
        ZIndex: =26

    Icon18_3 As icon.BackArrow:
        Color: =RGBA(39, 113, 194, 1)
        Icon: =Icon.Home
        OnSelect: =Navigate(HomeUser,ScreenTransition.None)
        Visible: |-
            =//If(varUserEmail="Danilo Nonod Jr.", true, false)
            true
        X: =34
        ZIndex: =27

    icn_sortDepartment As icon.ArrowDown:
        Color: =RGBA(215,213,240,1)
        Height: =40
        Icon: =Icon.Sort
        OnSelect: |-
            =UpdateContext({locShowSpinner_2:true});
            Concurrent(
            UpdateContext({locShowSpinner_3:false}),
            UpdateContext({SortAsDes:!SortAsDes}), 
            Set(VRY,{}), 
            Set(VRYY,{}),
            UpdateContext({sorte:!sorte})
            );
            UpdateContext({locShowSpinner_2:!locShowSpinner_2})
        Tooltip: ="Sort By Total Population"
        Visible: =!locShowSpinner_2 && !IsBlank(gal_FuncStat)
        Width: =34
        X: =312
        Y: =69
        ZIndex: =28

    lbl_duedate As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(215, 223, 240, 1)
        Height: =30
        Size: =10
        Text: |-
            ="Due Date:"
        Width: =78
        X: =1149
        Y: =83
        ZIndex: =29

    Button19_3 As button:
        Height: =71
        OnSelect: |+
            =ClearCollect( AllState, ShowColumns(
                AddColumns(
                    myHREmplist,
                    "Progress",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                
                        Text(Progress*100, "0%")
                    ),
                    "DateTime",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        DateTime),
                    "TotalScore",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        TotalScore 
                    ))
                
                
                , "field_EmployeeName","field_Function","field_ManagerName","Progress", "DateTime", "TotalScore"
            )
            );
            
            Concurrent(
            
            ClearCollect(myFuncAllDes, AddColumns(Sort(GroupBy(AllState,"field_Function","Department"), CountRows(Department), SortOrder.Descending), "TotalQty",
                     CountRows(Department),
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progress",
            
                              Sum(Department, !IsBlank(Progress) && Progress <> "100%" && IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 ),
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                    
                      )
                      
            ),
            
            ClearCollect(myFuncAllAsc, AddColumns(Sort(GroupBy(AllState,"field_Function","Department"), CountRows(Department), SortOrder.Descending), "TotalQty",
                     CountRows(Department),
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progress",
            
                        Sum(Department, !IsBlank(Progress) && Progress <> "100%" && IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore)
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 ),
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                      
                      )
                      
            ))
            
        Text: ="AddColumnCalculation"
        Visible: =false
        Width: =238
        Y: =415
        ZIndex: =30

    "gal_FuncStat As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        BorderColor: |
            =If(!IsBlank(gal_FuncStat),RGBA(0, 18, 107, 1), Color.Transparent)
        BorderThickness: =1
        Default: =VRY
        Fill: =Color.White
        Height: =637
        Items: =If(sorte,SortByColumns(myFuncAllDes,"TotalQty", SortOrder.Ascending), SortByColumns(myFuncAllDes,"TotalQty", SortOrder.Descending))
        Layout: =Layout.Vertical
        OnSelect: |-
            =UpdateContext({locShowSpinner_3:true});
            //UpdateContext({GroupPop:false});
            Concurrent(
            ClearCollect(myFunctionStatus,GroupBy(gal_FuncStat.Selected.Department,"field_ManagerName","Department")),
            UpdateContext({galhide:!galhide})
            );
            UpdateContext({locShowSpinner_3:false})
        ShowScrollbar: =false
        TemplateFill: =If(ThisItem.IsSelected,RGBA(215,213,240,1),ColorValue("White"))
        TemplatePadding: =0
        TemplateSize: =43
        Transition: =Transition.Pop
        Visible: =!locShowSpinner_2 && !IsEmpty(gal_FuncStat)
        Width: =620
        X: =90
        Y: =119
        ZIndex: =31

        TTLqty_5 As label:
            Align: =LayoutAlignItems.Center
            Height: =39
            OnSelect: =
            Text: =ThisItem.TotalQtye
            Width: =48
            X: =262
            ZIndex: =2

        TTLqty_Not_Started_5 As label:
            Align: =LayoutAlignItems.Center
            Height: =39
            OnSelect: =Select(Parent)
            Text: =ThisItem.NotYetStarted
            Width: =58
            X: =438
            Y: =1
            ZIndex: =3

        TTLqty_Ongoing_5 As label:
            Align: =LayoutAlignItems.Center
            Height: =39
            OnSelect: =Select(Parent)
            Text: =ThisItem.'In-progressQuiz=0' + ThisItem.'In-progressQuiz<95' + ThisItem.'In-progress'
            Width: =58
            X: =374
            Y: =2
            ZIndex: =4

        TTLqty_Completed_5 As label:
            Align: =LayoutAlignItems.Center
            Height: =38
            OnSelect: =Select(Parent)
            Text: =ThisItem.Completed
            Width: =46
            X: =327
            Y: =1
            ZIndex: =5

        Bar_Completed_5 As rectangle:
            Fill: =RGBA(54, 176, 75, 1)
            Height: =25
            OnSelect: =Select(Parent)
            Tooltip: =Text((TTLqty_Completed_5.Text/TTLqty_5.Text)*100, "0%")
            Width: =(TTLqty_Completed_5.Text/TTLqty_5.Text)*100
            X: =TTLqty_Not_Started_5.X + TTLqty_Not_Started_5.Width + 2
            Y: =6
            ZIndex: =6

        Bar_Not_Started_7 As rectangle:
            Fill: =RGBA(255, 0, 0, 1)
            Height: =25
            OnSelect: =Select(Parent)
            Tooltip: =Text((TTLqty_Not_Started_5.Text/TTLqty_5.Text)*100, "0%")
            Width: =(TTLqty_Not_Started_5.Text/TTLqty_5.Text)*100
            X: =Bar_Ongoing_1.X+Bar_Ongoing_1.Width
            Y: =Bar_Ongoing_1.Y
            ZIndex: =7

        Txt_TTLqty_Not_Completed_3 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =Bar_Not_Started_7.Height
            Italic: =true
            Size: =If(Value(Txt_TTLqty_Completed_3.Text)<65%,8,0)
            Text: =Text((TTLqty_Not_Started_5.Text/TTLqty_5.Text)*100, "0%")
            Tooltip: =Text((TTLqty_Not_Started_5.Text/TTLqty_5.Text)*100, "0%") & ", NotYetStarted"
            Visible: =!locShowSpinner_2
            Width: =Bar_Not_Started_7.Width
            X: =Bar_Not_Started_7.X
            Y: =Bar_Not_Started_7.Y
            ZIndex: =8

        Txt_TTLqty_Completed_3 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =Bar_Not_Started_7.Height
            Italic: =true
            Size: =If(Value(Txt_TTLqty_Not_Completed_3.Text)<=65%,8,0)
            Text: =If((TTLqty_Completed_5.Text/TTLqty_5.Text) = 1, Text((TTLqty_Completed_5.Text/TTLqty_5.Text)*100, "0%"), Text((TTLqty_Completed_5.Text/TTLqty_5.Text)*100, "0.0%"))
            Tooltip: =Text((TTLqty_Completed_5.Text/TTLqty_5.Text)*100, "0%") & ", Completed"
            Visible: =!locShowSpinner_2
            Width: =Bar_Completed_5.Width
            X: =Bar_Completed_5.X
            Y: =Bar_Completed_5.Y
            ZIndex: =9

        Button18_9 As button:
            Align: =Align.Left
            AutoDisableOnSelect: =false
            BorderColor: =ColorFade(Self.Fill, 15%)
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =37
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: |-
                =//ColorFade(RGBA(215,213,240,1), -20%)
                RGBA(215,213,240,1)
            Italic: =true
            OnSelect: =
            PressedColor: =Color.White
            PressedFill: =RGBA(215,213,240,1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =13
            Text: =ThisItem.field_Function
            Width: =273
            Y: =2
            ZIndex: =10

        Rectangle7_5 As rectangle:
            Fill: =RGBA(175, 191, 224, 1)
            Height: =1
            OnSelect: =Select(Parent)
            Width: =598
            Y: =39
            ZIndex: =11

        Bar_Ongoing_1 As rectangle:
            Fill: =RGBA(255, 255, 0, 1)
            Height: =25
            OnSelect: =Select(Parent)
            Tooltip: =Text((TTLqty_Completed_5.Text/TTLqty_5.Text)*100, "0%")
            Width: =(TTLqty_Ongoing_5.Text/TTLqty_5.Text)*100
            X: =Bar_Completed_5.X + Bar_Completed_5.Width
            Y: =Bar_Completed_5.Y
            ZIndex: =12

        Txt_TTLqty_Ongoing_1 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =Bar_Not_Started_7.Height
            Italic: =true
            Size: =If(Value(Txt_TTLqty_Not_Completed_3.Text)<=65%,8,0)
            Text: =Text((TTLqty_Ongoing_5.Text/TTLqty_5.Text)*100, "0%")
            Tooltip: =Text((TTLqty_Ongoing_5.Text/TTLqty_5.Text)*100, "0%") & ", In-progress"
            Visible: =!locShowSpinner_2
            Width: =Bar_Ongoing_1.Width
            X: =Bar_Ongoing_1.X
            Y: =Bar_Ongoing_1.Y
            ZIndex: =13

    OA_TTLqty_Completed As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =32
        Size: =15
        Text: =Sum(gal_FuncStat.AllItems,TTLqty_Completed_5.Text)
        Visible: =!locShowSpinner_2
        Width: =63
        X: =OA_TTLqty.X+OA_TTLqty.Width
        Y: =OA_TTLqty.Y
        ZIndex: =32

    "'OA_TTLqty_In-Progress' As label":
        Align: =LayoutAlignItems.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =32
        Size: =15
        Text: =Sum(gal_FuncStat.AllItems,TTLqty_Ongoing_5.Text)
        Visible: =!locShowSpinner_2
        Width: =OA_TTLqty_Completed.Width
        X: =OA_TTLqty_Completed.X+OA_TTLqty_Completed.Width
        Y: =OA_TTLqty.Y
        ZIndex: =33

    OA_TTLqty_NotYetStarted As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(255, 255, 255, 1)
        Height: =32
        Size: =15
        Text: =Sum(gal_FuncStat.AllItems,TTLqty_Not_Started_5.Text)
        Visible: =!locShowSpinner_2
        Width: ='OA_TTLqty_In-Progress'.Width
        X: ='OA_TTLqty_In-Progress'.X+'OA_TTLqty_In-Progress'.Width
        Y: =OA_TTLqty.Y
        ZIndex: =34

    Button19_4 As button:
        Height: =71
        OnSelect: |-
            =ClearCollect( AllState, ShowColumns(
                AddColumns(
                    myHREmplist,
                    "Progress",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                
                        Text(Progress*100, "0%")
                    ),
                    "DateTime",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        DateTime),
                    "TotalScore",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        TotalScore 
                    ))
                
                
                , "field_EmployeeName","field_Function","field_ManagerName","Progress", "DateTime", "TotalScore"
            )
            );
            Concurrent(
            
            ClearCollect(myFuncAllEmpDes, DropColumns(AddColumns(Sort(GroupBy(AllState,"field_EmployeeName","Department"), CountRows(Department), SortOrder.Descending),
            "DateTime",
                     DateValue(DateTime),
            "TotalQty",
                     CountRows(Department),
            
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore) && TotalScore <> 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 )
                      ,
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                    
                      ), "Department")),
            
            
            ClearCollect(myFuncAllEmpAsc, DropColumns(AddColumns(Sort(GroupBy(AllState,"field_EmployeeName","Department"), CountRows(Department), SortOrder.Descending),
            "TotalQty",
                     CountRows(Department),
            
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore) && TotalScore <> 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 )
                      ,
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                    
                      ), "Department")));
            
            ClearCollect( AllStatee,
                AddColumns(
                    AllState,
                    "Completed",
                    LookUp(
                        myFuncAllEmpAsc,
                        field_EmployeeName = AllState[@field_EmployeeName],
                            Completed),
                                    "NotYetStarted",
                    LookUp(
                        myFuncAllEmpAsc,
                        field_EmployeeName = AllState[@field_EmployeeName],
                    NotYetStarted),
                            "In-progressQuiz=0",
                    LookUp(
                        myFuncAllEmpAsc,
                        field_EmployeeName = AllState[@field_EmployeeName],
                            "In-progressQuiz=0"),
                                    "In-progressQuiz<95",
                    LookUp(
                        myFuncAllEmpAsc,
                        field_EmployeeName = AllState[@field_EmployeeName],
                    "In-progressQuiz<95")
                    
                    
                    
                    ));
            
            
            
            
            /*
            Set(varExport, ExportDataFromPowerApps.Run(JSON(myFuncAllEmpAsc,JSONFormat.IncludeBinaryData & JSONFormat.IgnoreUnsupportedTypes)).filelink); Launch(varExport); Clear(myFuncAllEmpAsc)
            ClearCollect( AllStatee,
                AddColumns(
                    AllState,
                    "Completed",
                    LookUp(
                        AllState,
                        field_EmployeeName = myFuncAllEmpAsc[@field_EmployeeName],
                            If(Progress = "100%", "Completed","")
                    )));
            */
        Text: ="AddColumnCalculationwithExport"
        Visible: =false
        Width: =238
        X: =761
        Y: =461
        ZIndex: =35

    Group11_5 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =35

        TTLqty_Overall_14 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(3, 92, 112, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =37
            Size: =9
            Text: ="TTL"
            Visible: =!locShowSpinner_2 && !IsEmpty(gal_FuncStat)
            Width: =78
            X: =335
            Y: =46
            ZIndex: =15

        Icon21_14 As icon.CancelBadge:
            Color: =RGBA(3, 92, 112, 1)
            DisplayMode: =DisplayMode.View
            Height: =23
            Icon: =Icon.CancelBadge
            Tooltip: ="NotYetStarted"
            Visible: =!locShowSpinner_2 && !IsEmpty(gal_FuncStat)
            Width: =52
            X: =532
            Y: =54
            ZIndex: =16

        Icon21_15 As icon.CancelBadge:
            Color: =RGBA(3, 92, 112, 1)
            DisplayMode: =DisplayMode.View
            Height: =23
            Icon: =Icon.Flag
            Tooltip: ="In-progress"
            Visible: =!locShowSpinner_2 && !IsEmpty(gal_FuncStat)
            Width: =52
            X: =469
            Y: =52
            ZIndex: =17

        Icon21_16 As icon.CancelBadge:
            Color: =RGBA(3, 92, 112, 1)
            DisplayMode: =DisplayMode.View
            Height: =23
            Icon: =Icon.CheckBadge
            Tooltip: ="Completed"
            Visible: =!locShowSpinner_2 && !IsEmpty(gal_FuncStat)
            Width: =52
            X: =401
            Y: =53
            ZIndex: =18

    Button19_5 As button:
        Height: =106
        OnSelect: |-
            =ClearCollect( AllState, ShowColumns(
                AddColumns(
                    myHREmplist,
                    "Progress",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                
                        Text(Progress*100, "0%")
                    ),
                    "DateTime",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        DateTime),
                    "TotalScore",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        TotalScore)
                    )
                
                
                , "field_EmployeeName","field_Function","field_ManagerName","Progress", "DateTime", "TotalScore"
            )
            );
            
            
            ClearCollect(myFuncAllManDes, DropColumns(AddColumns(Sort(GroupBy(AllState,"field_ManagerName","Department"), CountRows(Department), SortOrder.Descending),
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore) && TotalScore <> 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 )
                      
                      
                      
                    
                      ), "Department"))
        Text: ="AddColumnCalculationwithExport"
        Visible: =false
        Width: =225
        X: =759
        Y: =554
        ZIndex: =36

    Button27 As button:
        OnSelect: |-
            =ClearCollect( AllState, ShowColumns(
                AddColumns(
                    myHREmplist,
                    "Progress",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                
                        Text(Progress*100, "0%")
                    ),
                    "DateTime",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        DateTime),
                    "TotalScore",
                    LookUp(
                        myProfileProgress,
                        User = Substitute(myHREmplist[@EmployeeName], "ñ", "Ã±"),
                        TotalScore 
                    ))
                
                
                , "field_EmployeeName","field_Function","field_ManagerName","Progress", "DateTime", "TotalScore"
            )
            );
            
            ForAll(
                ForAll(Distinct(
                    AllState,
                    field_ManagerName
                ), {Result: ThisRecord.Value}), Collect(RETR,
                LookUp(
                    AllState,
                    field_ManagerName= Result
                )));
             
                ClearCollect(myFuncAllManDes, DropColumns(AddColumns(Sort(GroupBy(AllState,"field_ManagerName","Department"), CountRows(Department), SortOrder.Descending),
            "TotalQty",
                     CountRows(Department),
            
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore) && TotalScore <> 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 )
                      ,
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                    
                      ), "Department"));
                   ClearCollect(AllStatze, 
                AddColumns(
                    myFuncAllManDes,
                    "field_Function",
                    LookUp(RETR,
                        field_ManagerName = myFuncAllManDes[@field_ManagerName],
                           field_Function
                    ))
                    
                    )   
            
                
        Text: ="Button(1)"
        Visible: =false
        X: =506
        Y: =7
        ZIndex: =37

    Button29 As button:
        OnSelect: |-
            =ClearCollect(myFuncAllManDes, DropColumns(AddColumns(Sort(GroupBy(AllState,"field_ManagerName","Department"), CountRows(Department), SortOrder.Descending),
            "TotalQty",
                     CountRows(Department),
            
                      "NotYetStarted",
                      Sum(Department, IsBlank(Progress) && IsBlank(TotalScore)),
            
                      "In-progressQuiz=0",
            
                      Sum(Department, Progress = "100%" && IsBlank(TotalScore) && TotalScore <> 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ) ,
                     "In-progressQuiz<95",
                     
                      Sum(Department, Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95
                      //&& DateTime>DateValue("10/12/2021")
            
                      ),
                               "Completed",
                      Sum(Department,Progress = "100%" && TotalScore >= 95 )
                      ,
                      
                      "TotalQtye",
                     CountRows(Department)
                      
                      
                      
                    
                      ), "Department"))
        Text: ="Button(2)"
        Visible: =false
        X: =707
        Y: =7
        ZIndex: =38

    Button30 As button:
        Height: =81
        OnSelect: |-
            =ClearCollect(AllStatze, 
                AddColumns(
                    myFuncAllManDes,
                    "field_Function",
                    LookUp(RETR,
                        field_ManagerName = myFuncAllManDes[@field_ManagerName],
                           field_Function
                    ))
                    
                    )
        Text: ="Button(3)"
        Visible: =false
        Width: =134
        X: =888
        ZIndex: =39

    "gal_ManStat As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
        BorderColor: |
            =//RGBA(0, 18, 107, 1)
            If(IsBlank(Label46_5),Color.Transparent, RGBA(0, 18, 107, 1))
        BorderThickness: =1
        Fill: =Color.White
        Height: =339
        Items: =SortByColumns(Filter(AllStatze, field_Function=gal_FuncStat.Selected.field_Function), "Rate", If(sortManStat, SortOrder.Ascending, SortOrder.Descending))
        Layout: =Layout.Vertical
        OnSelect: |-
            =UpdateContext({GroupPop:true})
        TemplateFill: =If(ThisItem.IsSelected,RGBA(215,213,240,1),ColorValue("White"))
        TemplatePadding: =0
        TemplateSize: =43
        Transition: =Transition.Pop
        Visible: =!locShowSpinner_2
        Width: =421
        X: =835
        Y: =177
        ZIndex: =40

        TTLqty_7 As label:
            Align: =LayoutAlignItems.Center
            BorderStyle: =BorderStyle.None
            BorderThickness: =1
            Height: =30
            OnSelect: =
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =ThisItem.TotalQty
            Width: =30
            X: =167
            Y: =4
            ZIndex: =2

        TTLqty_Not_Started_7 As label:
            Align: =LayoutAlignItems.Center
            Height: =30
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =ThisItem.NotYetStarted
            Width: =30
            X: =261
            Y: =3
            ZIndex: =3

        TTLqty_Ongoing_7 As label:
            Align: =LayoutAlignItems.Center
            Height: =30
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =ThisItem.'In-progressQuiz=0' + ThisItem.'In-progressQuiz<95' + ThisItem.'In-progress'
            Visible: =!locShowSpinner_9 && !locShowSpinner_2
            Width: =30
            X: =231
            Y: =4
            ZIndex: =4

        TTLqty_Completed_7 As label:
            Align: =LayoutAlignItems.Center
            Height: =30
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10
            Text: =ThisItem.Completed
            Width: =30
            X: =198
            Y: =4
            ZIndex: =5

        Bar_Completed_7 As rectangle:
            Fill: =RGBA(54, 176, 75, 1)
            Height: =25
            OnSelect: =Select(Parent)
            Tooltip: =Text((TTLqty_Completed_7.Text/TTLqty_7.Text)*100, "0%")
            Width: =(TTLqty_Completed_7.Text/TTLqty_7.Text)*100
            X: =TTLqty_Not_Started_7.X + TTLqty_Not_Started_7.Width + 2
            Y: =6
            ZIndex: =6

        Bar_Not_Started_9 As rectangle:
            Fill: =RGBA(255, 0, 0, 1)
            Height: =25
            OnSelect: =Select(Parent)
            Tooltip: =Text((TTLqty_Not_Started_7.Text/TTLqty_7.Text)*100, "0%")
            Width: =(TTLqty_Not_Started_7.Text/TTLqty_7.Text)*100
            X: =Bar_Ongoing_3.X+Bar_Ongoing_3.Width
            Y: =Bar_Ongoing_3.Y
            ZIndex: =7

        Txt_TTLqty_Not_Completed_5 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =Bar_Not_Started_9.Height
            Italic: =true
            Size: =If(Value(Txt_TTLqty_Completed_5.Text)<65%,8,0)
            Text: =Text((TTLqty_Not_Started_7.Text/TTLqty_7.Text)*100, "0%")
            Tooltip: =Text((TTLqty_Not_Started_7.Text/TTLqty_7.Text)*100, "0%") & ", NotYetStarted"
            Visible: =!locShowSpinner_2
            Width: =Bar_Not_Started_9.Width
            X: =Bar_Not_Started_9.X
            Y: =Bar_Not_Started_9.Y
            ZIndex: =8

        Txt_TTLqty_Completed_5 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =Bar_Not_Started_9.Height
            Italic: =true
            Size: =If(Value(Txt_TTLqty_Not_Completed_5.Text)<65%,8,0)
            Text: =Text((TTLqty_Completed_7.Text/TTLqty_7.Text)*100, "0%")
            Tooltip: =Text((TTLqty_Completed_7.Text/TTLqty_7.Text)*100, "0%") & ", Completed"
            Visible: =!locShowSpinner_2
            Width: =Bar_Completed_7.Width
            X: =Bar_Completed_7.X
            Y: =Bar_Completed_7.Y
            ZIndex: =9

        Button18_11 As button:
            Align: =Align.Left
            AutoDisableOnSelect: =false
            BorderColor: =ColorFade(Self.Fill, 15%)
            Color: =RGBA(0, 0, 0, 1)
            Fill: =RGBA(0, 0, 0, 0)
            FontWeight: =FontWeight.Lighter
            Height: =39
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: |-
                =//ColorFade(RGBA(215,213,240,1), -20%)
                RGBA(215,213,240,1)
            OnSelect: |-
                =UpdateContext({GroupPop:true})
            PressedColor: =Color.White
            PressedFill: =RGBA(215,213,240,1)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =12
            Text: =ThisItem.ManName
            Width: =167
            Y: =2
            ZIndex: =10

        Rectangle7_7 As rectangle:
            Fill: =RGBA(175, 191, 224, 1)
            Height: =2
            OnSelect: =Select(Parent)
            Width: =488
            Y: =39
            ZIndex: =11

        Bar_Ongoing_3 As rectangle:
            Fill: =RGBA(255, 255, 0, 1)
            Height: =25
            OnSelect: =Select(Parent)
            Tooltip: =Text((TTLqty_Completed_7.Text/TTLqty_7.Text)*100, "0%")
            Width: =(TTLqty_Ongoing_7.Text/TTLqty_7.Text)*100
            X: =Bar_Completed_7.X + Bar_Completed_7.Width
            Y: =Bar_Completed_7.Y
            ZIndex: =12

        Txt_TTLqty_Ongoing_3 As label:
            Align: =LayoutAlignItems.Center
            Height: =Bar_Not_Started_9.Height
            Italic: =true
            Size: =If(Value(Txt_TTLqty_Completed_5.Text)<=65%,8,0)
            Text: =Text((TTLqty_Ongoing_7.Text/TTLqty_7.Text)*100, "0%")
            Tooltip: =Text((TTLqty_Ongoing_7.Text/TTLqty_7.Text)*100, "0%") & ", In-progress"
            Visible: =!locShowSpinner_2
            Width: =Bar_Ongoing_3.Width
            X: =Bar_Ongoing_3.X
            Y: =Bar_Ongoing_3.Y
            ZIndex: =13

    lbl_TTLqty_InProgress As label:
        Align: =LayoutAlignItems.Center
        Height: =27
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Size: =8
        Text: =Text(('OA_TTLqty_In-Progress'.Text/OA_TTLqty.Text)*100, "0%")
        Tooltip: =Text(('OA_TTLqty_In-Progress'.Text/OA_TTLqty.Text)*100, "0%") & ", In-progress"
        Visible: =!locShowSpinner_2
        Width: =Bar_OA_Ongoing_2.Width
        X: =Bar_OA_Ongoing_2.X
        Y: =Bar_OA_NotStarted_2.Y
        ZIndex: =41

    popfreeze As rectangle:
        Fill: =RGBA(56, 96, 178, 0.5)
        Height: =768
        Visible: =GroupPop
        Width: =1366
        ZIndex: =47

    btn_PerFunction_3 As button:
        Height: =60
        OnSelect: |-
            =ClearCollect(HARD, DropColumns(AddColumns(AllState, "Remarks",
            If(IsBlank(Progress), "NotYetStarted",
            If(Value(Progress) < 100%, "In-progress",
            If(Value(Progress) = 100%, "Completed")))),"TotalScore"));
            
            Set(varExport, ExportDataFromPowerApps.Run(JSON(HARD,JSONFormat.IncludeBinaryData & JSONFormat.IgnoreUnsupportedTypes)).filelink); Launch(varExport); Clear(HARD)
            
            
            /*
            If(IsBlank(Progress) && IsBlank(TotalScore), "NotYetStarted",
            If(Value(Progress) < 100% && IsBlank(TotalScore), "In-progress",
            If(Progress = "100%" && IsBlank(TotalScore) && TotalScore <> 95, "In-progress: No Recorded Quiz",
            If(Progress = "100%" && !IsBlank(TotalScore) && TotalScore < 95, "In-progress: For re-take Quiz",
            If(Progress = "100%" && TotalScore >= 95, "Completed")))))));
            */
        Text: ="ExportDataALL"
        Visible: =!IsBlank(Label44_4.Text) && (varUserEmail="Danilo Nonod Jr." || varUserEmail="Mark Henry Laparan" || varUserEmail="Ray Nicanor Tag-At")
        X: =1152
        Y: =587
        ZIndex: =55

    Label44_6 As label:
        Align: =Align.Center
        Height: =32
        Text: ="For Admin"
        Visible: =!IsBlank(Label44_4.Text) && (varUserEmail="Danilo Nonod Jr." || varUserEmail="Mark Henry Laparan" || varUserEmail="Ray Nicanor Tag-At")
        Width: =235
        X: =1107
        Y: =555
        ZIndex: =56

    Group11_6 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =56

        TTLqty_Overall_18 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(3, 92, 112, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =28
            Size: =9
            Text: ="TTL"
            Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
            Width: =47
            X: =987
            Y: =156
            ZIndex: =50

        Icon21_18 As icon.CancelBadge:
            Color: =RGBA(3, 92, 112, 1)
            DisplayMode: =DisplayMode.View
            Height: =17
            Icon: =Icon.CancelBadge
            Tooltip: ="NotYetStarted"
            Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
            Width: =31
            X: =1091
            Y: =160
            ZIndex: =51

        Icon21_19 As icon.CancelBadge:
            Color: =RGBA(3, 92, 112, 1)
            DisplayMode: =DisplayMode.View
            Height: =17
            Icon: =Icon.Flag
            Tooltip: ="In-progress"
            Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
            Width: =31
            X: =1061
            Y: =159
            ZIndex: =52

        Icon21_20 As icon.CancelBadge:
            Color: =RGBA(3, 92, 112, 1)
            DisplayMode: =DisplayMode.View
            Height: =17
            Icon: =Icon.CheckBadge
            Tooltip: ="Completed"
            Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
            Width: =31
            X: =1026
            Y: =161
            ZIndex: =53

    locShowSpinner_10 As image:
        Image: =spinner
        Visible: =locShowSpinner_VG
        X: =685
        Y: =267
        ZIndex: =57

    Label33 As label:
        Text: =
        X: =40
        Y: =40
        ZIndex: =58

    popfreeze_1 As rectangle:
        Fill: =RGBA(56, 96, 178, 0.1)
        Height: =768
        Visible: =locShowSpinner_VG
        Width: =1366
        ZIndex: =59

    Icon23_3 As icon.Cancel:
        BorderColor: =RGBA(255, 255, 0, 1)
        Color: =RGBA(0, 0, 0, 1)
        Fill: =RGBA(255, 255, 0, 1)
        Height: =57
        Icon: =Icon.Cancel
        OnSelect: |-
            =UpdateContext({GroupPop:!GroupPop})
        Visible: =GroupPop
        Width: =50
        X: =1312
        ZIndex: =60

    Label48 As label:
        Color: =RGBA(255, 255, 255, 1)
        Height: =36
        Text: ="("&CountRows(Filter(gal_EmpStat.AllItems, Progress="100%")) &"/"&CountRows(gal_EmpStat.AllItems)& ") "& Last(Filter(AllState, ManName=gal_ManStat.Selected.ManName)).ManName &"'s" & " Direct Report"
        Visible: =GroupPop
        Width: =411
        X: =816
        Y: =122
        ZIndex: =61

    Label44_5 As label:
        Height: =22
        Size: =10
        Text: ="ManagerName"
        Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
        Width: =108
        X: =827
        Y: =154
        ZIndex: =62

    lbl_DateTimeStamp As label:
        Color: =RGBA(9, 33, 98, 1)
        DisplayMode: =DisplayMode.View
        Height: =34
        Size: =10
        Text: |-
            ="Datetime: " & Text(timestamp,"[$-en-US]mm/dd/yy hh:mm:ss AM/PM") & Char(10) & "LastUpdate: " & timestamp_esd
        Tooltip: ="Click Refresh to get the latest update!"
        Visible: =!locShowSpinner_2
        Width: =226
        X: =107
        Y: =46
        ZIndex: =65

    timer_5 As timer:
        AutoStart: =true
        Duration: =0
        OnTimerEnd: = Set(timestamp,Now())
        OnTimerStart: =true
        Repeat: =true
        Visible: =false
        X: =12
        Y: =128
        ZIndex: =66

    Group13 As group:
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =66

        Rectangle6_6 As rectangle:
            Fill: =RGBA(0, 0, 0, 1)
            Height: =40
            Visible: =GroupPop
            Width: =459
            X: =816
            Y: =121
            ZIndex: =42

        Rectangle6_7 As rectangle:
            Fill: =RGBA(128, 128, 128, 1)
            Height: =410
            Visible: =GroupPop
            Width: =459
            X: =817
            Y: =160
            ZIndex: =43

        TTLqty_Overall_16 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =34
            Size: =9
            Text: ="Status"
            Visible: =GroupPop
            Width: =68
            X: =993
            Y: =154
            ZIndex: =44

        Icon21_17 As icon.CancelBadge:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =22
            Icon: =Icon.CalendarBlank
            Tooltip: ="Completion Date"
            Visible: =GroupPop
            Width: =29
            X: =1090
            Y: =163
            ZIndex: =45

        TTLqty_Overall_15 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =31
            Size: =9
            Text: ="EmployeeName"
            Visible: =GroupPop
            Width: =149
            X: =810
            Y: =157
            ZIndex: =46

        Icon23_2 As icon.Cancel:
            Color: =RGBA(255, 255, 0, 1)
            Height: =30
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({GroupPop:!GroupPop})
            Visible: =GroupPop
            Width: =36
            X: =1230
            Y: =125
            ZIndex: =48

        TTLqty_Overall_17 As label:
            Align: =LayoutAlignItems.Center
            Color: =RGBA(255, 255, 255, 1)
            Height: =33
            Size: =9
            Text: ="Remarks"
            Visible: =GroupPop
            Width: =90
            X: =1147
            Y: =159
            ZIndex: =49

        "gal_EmpStat As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
            BorderThickness: =1
            Default: =VRY
            Height: =381
            Items: |-
                =If(sortName, SortByColumns(Filter(AllState, ManName=gal_ManStat.Selected.ManName), "EmpName", If(sortName, SortOrder.Ascending, SortOrder.Descending)),
                SortByColumns(Filter(AllState, ManName=gal_ManStat.Selected.ManName), "DateTime", If(sortDate, SortOrder.Ascending, SortOrder.Descending)))
            Layout: =Layout.Vertical
            TemplateFill: =If(ThisItem.IsSelected,RGBA(215,213,240,1),ColorValue("White"))
            TemplatePadding: =0
            TemplateSize: =38
            Visible: =GroupPop
            Width: =449
            X: =821
            Y: =189
            ZIndex: =54

            Bar_Not_Started_8 As rectangle:
                Fill: |-
                    =//RGBA(255, 0, 0, 1)
                    If(IsBlank(ThisItem.Progress) //&& IsBlank(ThisItem.TotalScore)
                    , Color.Red,
                    If(Value(ThisItem.Progress)<100% //&& (IsBlank(ThisItem.TotalScore) || ThisItem.TotalScore < 95)
                    , Color.Yellow,
                    If(Value(ThisItem.Progress)=100%  //&& ThisItem.TotalScore >= 95
                    , ColorValue("#36B04B"))))
                Height: =23
                OnSelect: =Select(Parent)
                Tooltip: |-
                    =If(Bar_Not_Started_8.Fill<>Color.Yellow,"", If(IsBlank(ThisItem.TotalScore), "Need To Take A QUIZ" & Char(10) & "Passing Rate:≥95%",
                    If(ThisItem.TotalScore < 95, Text(ThisItem.TotalScore *100, "0%") & "Need To Re-Take A QUIZ")))
                Width: =31
                X: =190
                Y: =10
                ZIndex: =8

            Button18_10 As button:
                Align: =Align.Left
                AutoDisableOnSelect: =false
                Color: =RGBA(0, 0, 0, 1)
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =32
                HoverColor: =RGBA(0, 0, 0, 1)
                HoverFill: |-
                    =//ColorFade(RGBA(215,213,240,1), -20%)
                    RGBA(215,213,240,1)
                Italic: =true
                PressedColor: =Color.White
                PressedFill: =RGBA(215,213,240,1)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10
                Text: =ThisItem.EmpName
                Width: =166
                X: =3
                Y: =6
                ZIndex: =9

            TTLqty_Completed_indv_4 As label:
                Align: =LayoutAlignItems.Center
                Height: =38
                OnSelect: =Select(Parent)
                Size: =9
                Text: |
                    =ThisItem.Progress
                Visible: =false
                Width: =35
                X: =207
                ZIndex: =10

            gal_EmpStat_lbl_DateTime As label:
                Align: =LayoutAlignItems.Center
                Height: =33
                OnSelect: =Select(Parent)
                Size: =9
                Text: =If(IsBlank(ThisItem.DateTime), "-", ThisItem.DateTime)
                Width: =85
                X: =238
                ZIndex: =12

            gal_EmpStat_lbl_TotalScore As label:
                Align: =LayoutAlignItems.Center
                Height: =31
                OnSelect: =Select(Parent)
                Size: =9
                Text: =ThisItem.TotalScore
                Visible: =false
                Width: =30
                X: =350
                Y: =7
                ZIndex: =14

            gal_EmpStat_lbl_Remarks As label:
                Align: =Align.Center
                Height: =31
                OnSelect: =Select(Parent)
                Size: =7
                Text: |-
                    =If(Bar_Not_Started_8.Fill=Color.Yellow //&& IsBlank(ThisItem.TotalScore), 
                    ,ThisItem.Progress &", In-progress",
                    If(Bar_Not_Started_8.Fill=Color.Red //&& ThisItem.TotalScore < 95
                    , "NotYetStarted",
                    If(Bar_Not_Started_8.Fill=ColorValue("#36B04B"), "😊 Completed", "")))
                Width: =95
                X: =323
                Y: =6
                ZIndex: =15

        icn_SortByName As icon.CancelBadge:
            Color: =RGBA(204, 204, 204, 1)
            Height: =22
            Icon: =Icon.Sort
            OnSelect: |-
                =UpdateContext({sortName:!sortName})
            Tooltip: ="Sort By Name"
            Visible: =GroupPop
            Width: =29
            X: =814
            Y: =162
            ZIndex: =63

        icn_SortByDate As icon.CancelBadge:
            Color: =RGBA(204, 204, 204, 1)
            Height: =22
            Icon: =Icon.Sort
            OnSelect: |-
                =UpdateContext({sortDate:!sortDate})
            Tooltip: ="Sort By Date"
            Visible: =GroupPop
            Width: =29
            X: =1068
            Y: =163
            ZIndex: =64

    TTLqty_Overall_19 As label:
        Align: =LayoutAlignItems.Center
        Color: =RGBA(3, 92, 112, 1)
        DisabledColor: =RGBA(244, 244, 244, 1)
        DisplayMode: =DisplayMode.View
        Height: =24
        Size: =7
        Text: ="Sort By Completion!"
        Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
        Width: =73
        X: =1159
        Y: =150
        ZIndex: =67

    Icon21_21 As icon.CancelBadge:
        Color: =RGBA(3, 92, 112, 1)
        Height: =22
        Icon: =Icon.Sort
        OnSelect: |-
            =UpdateContext({sortManStat:!sortManStat})
        Tooltip: ="Click to Sort Completion Rate By Manager."
        Visible: =If(IsBlank(Label46_5) || GroupPop,false, true)
        Width: =21
        X: =1147
        Y: =154
        ZIndex: =68

